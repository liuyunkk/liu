<!DOCTYPE html>
<html>
<head>
    <title>从URL获取手机号并批量调用接口</title>
</head>
<body>
    <h1>从URL获取手机号并批量调用接口</h1>

    <div id="response"></div>

    <script>
        // 获取当前页面的 URL
        const currentUrl = window.location.href;

        // 使用 URL 构造函数来解析 URL
        const url = new URL(currentUrl);

        // 获取手机号参数
        const phone = url.searchParams.get('phone');

        if (phone) {
            // 判断手机号是否为11位
            if (phone.length === 11) {
                // 定义要添加的请求头参数
                const customHeaders = {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer YourAccessToken' // 示例：添加授权头
                };

                // 接口 URL 列表，每个接口都包含 $d 作为占位符
                const urls = [
                    'https://zy.xywlapi.cc/qqphone?phone=$d'
                ];

                // 使用 Promise.all 来批量发送请求
                Promise.all(urls.map(url => {
                    // 将 $d 替换为手机号
                    const apiUrl = url.replace('$d', phone);

                    // 发送 GET 请求，包括自定义请求头
                    return fetch(apiUrl, {
                        method: 'GET',
                        headers: customHeaders // 添加自定义请求头
                    })
                    .then(response => response.json());
                }))
                .then(responses => {
                    document.getElementById('response').innerHTML = responses.map((response, index) => 
                        `<h3>接口 ${index + 1} 的响应:</h3><pre>${JSON.stringify(response, null, 2)}</pre>`
                    ).join('');
                })
                .catch(error => {
                    console.error('有些接口调用失败：', error);
                });
            } else {
                document.getElementById('response').innerHTML = '手机号必须为11位';
            }
        } else {
            document.getElementById('response').innerHTML = 'URL 中未提供手机号参数';
        }
    </script>
</body>
</html>
